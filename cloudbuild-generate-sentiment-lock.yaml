timeout: 1800s

options:
  logging: LEGACY

steps:
  - name: "python:3.11-slim"
    id: lock-sentiment-processor
    entrypoint: "sh"
    args:
      - "-c"
      - |
        python -m pip install --no-cache-dir poetry==1.7.1
        cd services/sentiment-processor
        poetry lock --no-interaction --no-ansi

  - name: "gcr.io/cloud-builders/gsutil"
    id: upload-sentiment-lock
    args:
      - "cp"
      - "services/sentiment-processor/poetry.lock"
      - "gs://${PROJECT_ID}_cloudbuild/locks/sentiment-processor/poetry.lock"

